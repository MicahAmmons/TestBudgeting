@using TestBudgeting.Models.Home;
@model HomeVar

<head>
    <link rel="stylesheet" href="/css/site.css">
</head>
    <style>
       
        body {
            background-color: #3E1B24;

        }

        .progress-container {
            width: 100%;
            background-color: #FFD5A7;
            position: relative;
            overflow: hidden;
            border-radius: 25px;
            height: 35px;
            color: #FFD5A7;
        }

        .progress-bar {
            background-color: #3E1B24;
            height: 30px;
            text-align: center;
            line-height: 30px;
            color: #FFD5A7;
            position: relative;
            border-radius: 25px;
            height: 30px;
            top: 2.5px;
            left: 2px;
            width: calc(100% - 4px);
        }

    .total-spent {
        position: absolute;
        left: 10px;
        top: 0;
        height: 100%;
        line-height: 30px; /* Adjust to match the progress bar height */
        color: #FFD5A7;
    }

        .budget-total {
            position: absolute;
            right: 10px; /* Adjust the right positioning as needed */
            top: 2px;
            height: 100%;
            line-height: 30px;
            color: #3E1B24;
        }
        .td{
        color: #FFD5A7;
        font-size: 10px;
        }

    .right-container {
        position: absolute;
        top: 0;
        left: 35%; /* Set left to 25% */
        text-align: left;
        padding: 10px; /* Optional padding for better readability */
    }

        .right-container h1 {
            font-size: 20px;
            color: #FFD5A7;
            border-bottom: 1px solid #FFD5A7;
        }
    </style>

<body>
    <button id="hideZeroButton">Hide 0</button>
    <!-- New Budget Button -->
    <div>
        <a href="/Budget/InsertBudget" class="body-link">New Budget</a>
    </div>

    <div class="right-container">
        <h1>Income @Model.MonthlyIncome </h1>
        <h1>Budget @Model.TotalMonthlyBudget</h1>
        <h1>Spent @Model.TotalMonthlySpent</h1>
    </div>
    <row>
        <h1>     </h1>
    </row>




 <div style="display: flex; width: 100%">
     <div style="flex: 1; width: 25%">

    @foreach (var budget in Model.BudgetCollection)
    {
        <div>
                    <h2 style="font-size: 25px; color:#FFD5A7;">
                        <span class="budget-name" data-budget-id="@budget.DistinctBudgets">@budget.DistinctBudgets</span>
                    </h2>
            <div class="progress-container">
                <div class="total-spent">@budget.TotalSpent</div>
                @{
                    var progressPercentage = (budget.TotalSpent / budget.BudgetAmount) * 100;
                    if (progressPercentage > 100)
                    {
                        progressPercentage = 100;
                    }

                    // Set the text color for BudgetAmount based on the progress
                    var budgetAmountTextColor = progressPercentage >= 95 ? "#FFD5A7" : "#3E1B24";
                }
                <div class="progress-bar" style="width: @(budget.TotalSpent / budget.BudgetAmount * 100)%;">
                    <span>@budget.TotalSpent</span>
                </div>
                <a href="@Url.Action("UpdateAmount", "Budget", new { id = budget.DistinctBudgets })" class="budget-total" style="color: @budgetAmountTextColor;">@budget.BudgetAmount</a>
            </div>

        </div>
        
    }
     </div>

        <div style="flex: 1; width: 2%">
            <!-- Empty div for blank space (25%) -->
        </div>

        <div style="flex: 1; width: 40%">
            <div style="display: flex; justify-content: center;">
                <div style="max-width: 100%; margin-top: 50px; background-color: #3E1B24; border: 3px solid #FFD5A7; border-radius: 25px; padding: 3px; overflow: auto;">
                    <table class="table table-condensed" style="border-collapse: collapse; border: none !important; table-layout: auto; border-radius: 25px;  border-radius: 25px;">
                    <thead style=" color: #3E1B24; font-weight: bold; font-size: 20px; text-align: center; padding: 5px;">
                        <tr>
                                <th style="color: #FFD5A7;">Amount</th>
                                <th style="color: #FFD5A7;">Payee</th>
                                <th style="color: #FFD5A7;">Budget</th>
                            <th style="color: #FFD5A7;">Day</th>
                        </tr>
                    </thead>
                    <tbody style="color:#FFD5A7; border: #FFD5A7; font-size: 12px; ">
                        @foreach (var expense in Model.ExpenseCollection)
                        {
                                <tr class="expense-row" data-expense-budget="@expense.Budget">
                                    <!-- Add the class and data attribute -->
                                <td>@expense.Amount</td>
                                <td>@expense.Payee</td>
                                <td>@expense.Budget</td>
                                <td>@expense.Day</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            </div>
        </div>
         <div style="flex: 1; width: 33%">
            <!-- Empty div for blank space (25%) -->
         </div>
</div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            // Event handler for clicking on budget namesa
            $(".budget-name").on("click", function () {
                var budgetId = $(this).data("budget-id");

                // Toggle visibility of related expenses
                $(".expense-row").each(function () {
                    var expenseBudget = $(this).data("expense-budget");
                    if (expenseBudget !== budgetId) {
                        $(this).toggle(); // Toggle visibility
                    }
                });
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            // Function to hide zero budgets and their names
            function hideZeroBudgets() {
                $(".progress-container").each(function () {
                    var budgetAmount = parseFloat($(this).find(".budget-total").text());
                    if (budgetAmount === 0) {
                        $(this).closest("div").hide();
                        $(this).closest("div").prev("h2").hide(); // Hide the budget name
                    }
                });
            }

            // Initially hide zero budgets and their names when the page loads
            hideZeroBudgets();

            // Event handler for clicking on the "Hide 0" button
            $("#hideZeroButton").on("click", function () {
                // Toggle the visibility of zero budgets and their names when the button is clicked
                $(".progress-container").each(function () {
                    var budgetAmount = parseFloat($(this).find(".budget-total").text());
                    if (budgetAmount === 0) {
                        $(this).closest("div").toggle();
                        $(this).closest("div").prev("h2").toggle(); // Toggle the visibility of the budget name
                    }
                });
            });
        });
    </script>
</body>

